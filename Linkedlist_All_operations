#include <stdio.h>
#include <stdlib.h>

typedef struct Node {
    int data;
    struct Node *next;
} Node;

void initialise_Node(Node **head, int *count) {
    *head = NULL;
    *count = 0;
}

/* INSERTION FUNCTIONS */

void insert_At_start(Node **head, int *count, int data) {
    Node *new_node = (Node*)malloc(sizeof(Node));
    if (new_node == NULL) return;

    new_node->data = data;
    new_node->next = *head;
    *head = new_node;
    (*count)++;
}

void insert_At_end(Node **head, int *count, int data) {
    if (*head == NULL) {
        insert_At_start(head, count, data);
        return;
    }

    Node *new_node = (Node*)malloc(sizeof(Node));
    if (!new_node) return;

    new_node->data = data;
    new_node->next = NULL;

    Node *temp = *head;
    while (temp->next != NULL)
        temp = temp->next;

    temp->next = new_node;
    (*count)++;
}

void insert_At_pos(Node **head, int *count, int data, int pos) {
    if (pos < 1 || pos > (*count) + 1)
        return;

    if (pos == 1) {
        insert_At_start(head, count, data);
        return;
    }

    Node *new_node = (Node*)malloc(sizeof(Node));
    if (!new_node) return;

    new_node->data = data;

    Node *temp = *head;
    for (int i = 1; i < pos - 1; i++)
        temp = temp->next;

    new_node->next = temp->next;
    temp->next = new_node;
    (*count)++;
}

void insert_after_key(Node **head, int *count, int data, int key) {
    Node *temp = *head;
    while (temp && temp->data != key)
        temp = temp->next;

    if (!temp) return;

    Node *new_node = (Node*)malloc(sizeof(Node));
    if (!new_node) return;

    new_node->data = data;
    new_node->next = temp->next;
    temp->next = new_node;

    (*count)++;
}

void insert_before_key(Node **head, int *count, int data, int key) {
    if (*head == NULL) return;

    if ((*head)->data == key) {
        insert_At_start(head, count, data);
        return;
    }

    Node *prev = *head;
    Node *cur = (*head)->next;

    while (cur && cur->data != key) {
        prev = cur;
        cur = cur->next;
    }

    if (!cur) return;

    Node *new_node = malloc(sizeof(Node));
    new_node->data = data;

    new_node->next = cur;
    prev->next = new_node;

    (*count)++;
}

/* DELETE FUNCTIONS */

void delete_At_beginning(Node **head, int *count) {
    if (!*head) return;

    Node *temp = *head;
    *head = temp->next;
    free(temp);
    (*count)--;
}

void delete_at_end(Node **head, int *count) {
    if (!*head) return;

    if ((*head)->next == NULL) {
        delete_At_beginning(head, count);
        return;
    }

    Node *temp = *head;
    while (temp->next->next != NULL)
        temp = temp->next;

    free(temp->next);
    temp->next = NULL;
    (*count)--;
}

void delete_at_pos(Node **head, int *count, int pos) {
    if (pos < 1 || pos > *count) return;

    if (pos == 1) {
        delete_At_beginning(head, count);
        return;
    }

    Node *prev = *head;
    Node *cur = (*head)->next;

    for (int i = 2; i < pos; i++) {
        prev = cur;
        cur = cur->next;
    }

    prev->next = cur->next;
    free(cur);
    (*count)--;
}

void delete_after_key(Node **head, int *count, int key) {
    Node *temp = *head;

    while (temp && temp->data != key)
        temp = temp->next;

    if (!temp || !temp->next) return;

    Node *del = temp->next;
    temp->next = del->next;
    free(del);

    (*count)--;
}

void delete_before_key(Node **head, int *count, int key) {
    if (*head == NULL || (*head)->data == key)
        return;

    if ((*head)->next && (*head)->next->data == key) {
        delete_At_beginning(head, count);
        return;
    }

    Node *prev = *head;
    Node *cur = (*head)->next;

    while (cur->next && cur->next->data != key) {
        prev = cur;
        cur = cur->next;
    }

    if (!cur->next) return;

    prev->next = cur->next;
    free(cur);
    (*count)--;
}

void display(Node *head) {
    if (!head) {
        printf("List is empty\n");
        return;
    }

    Node *temp = head;
    printf("Linked List: ");
    while (temp) {
        printf("%d -> ", temp->data);
        temp = temp->next;
    }
    printf("NULL\n");
}

/* MAIN MENU */

int main() {
    Node *head;
    int count;
    initialise_Node(&head, &count);

    int choice, data, pos, key;

    while (1) {
        printf("\n--- MENU ---\n");
        printf("1. Insert at beginning\n");
        printf("2. Insert at end\n");
        printf("3. Insert at position\n");
        printf("4. Insert before key\n");
        printf("5. Insert after key\n");
        printf("6. Delete at beginning\n");
        printf("7. Delete at end\n");
        printf("8. Delete at position\n");
        printf("9. Delete before key\n");
        printf("10. Delete after key\n");
        printf("11. Display\n");
        printf("12. Exit\n");

        printf("Enter choice: ");
        scanf("%d", &choice);

        switch (choice) {

            case 1:
                printf("Enter value: ");
                scanf("%d", &data);
                insert_At_start(&head, &count, data);
                break;

            case 2:
                printf("Enter value: ");
                scanf("%d", &data);
                insert_At_end(&head, &count, data);
                break;

            case 3:
                printf("Enter value: ");
                scanf("%d", &data);
                printf("Enter position: ");
                scanf("%d", &pos);
                insert_At_pos(&head, &count, data, pos);
                break;

            case 4:
                printf("Enter value: ");
                scanf("%d", &data);
                printf("Enter key: ");
                scanf("%d", &key);
                insert_before_key(&head, &count, data, key);
                break;

            case 5:
                printf("Enter value: ");
                scanf("%d", &data);
                printf("Enter key: ");
                scanf("%d", &key);
                insert_after_key(&head, &count, data, key);
                break;

            case 6:
                delete_At_beginning(&head, &count);
                break;

            case 7:
                delete_at_end(&head, &count);
                break;

            case 8:
                printf("Enter position: ");
                scanf("%d", &pos);
                delete_at_pos(&head, &count, pos);
                break;

            case 9:
                printf("Enter key: ");
                scanf("%d", &key);
                delete_before_key(&head, &count, key);
                break;

            case 10:
                printf("Enter key: ");
                scanf("%d", &key);
                delete_after_key(&head, &count, key);
                break;

            case 11:
                display(head);
                break;

            case 12:
                exit(0);

            default:
                printf("Invalid choice!\n");
        }
    }

    return 0;
}
